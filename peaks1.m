M1=dlmread('solids/overlap2.dat',' '); x=M1(:,1);y=M1(:,2);z=M1(:,3);
X=[x;x+1;x;x+1];Y=[y;y;y+1;y+1];Z=[z;z;z;z]; R2=unique([X Y Z],'rows');
TOL=1e-6;
R1=R2;
%R1=R2(R2(:,1)>=-TOL & R2(:,1)<=(1+TOL) & R2(:,2)>=-TOL & R2(:,2)<=(1+TOL),:);
C = textread('chosen.solution.txt', '%s','delimiter', ' ');
xlab=['x=[',C{10},C{11},C{12},']']; ylab=['y=[',C{13},C{14},C{15},']'];
xlab1=['[',C{10},C{11},C{12},']']; ylab1=['[',C{13},C{14},C{15},']'];
tri=delaunay(R1(:,1),R1(:,2));

set(groot,'defaultAxesTickLabelInterpreter','latex'); set(groot,'defaultLegendInterpreter','latex');

f1=figure('Position', [100, 100, 800, 600], 'defaultLineLineWidth',2.5,'DefaultAxesFontSize',25);
%trisurf(tri,R1(:,1),R1(:,2),R1(:,3),'LineStyle','none');
ax=gca; ax.FontSize=25; ax.LineWidth=1.5;
set(ax,'TickLabelInterpreter', 'latex');
set(ax,'Position', [0.13 0.13 0.775 0.8]);
ax.XTick = min(R1(:,1)):0.25:max(R1(:,1)); ax.YTick = min(R1(:,2)):0.25:max(R1(:,2));
%ax.XLabel.String = '{\lambda}_{[100$$\overline{x}$$]}/b_{[100]}'; ax.YLabel.String = '{\lambda}_{[010]}/b_{[010]}'; ax.ZLabel.String = 'overlap volume (Ã…^3)';
xlabel('$$\mathrm{{\lambda}_{[100]}/b_{[100]}}$$','Interpreter','latex','FontSize',35);
ylabel('$$\mathrm{{\lambda}_{[010]}/b_{[010]}}$$','Interpreter','latex','FontSize',35);
ax.YLabel.Position(1)=ax.YLabel.Position(1)-0.61;
ax.XLabel.Position(2)=ax.XLabel.Position(2)-0.55;
x=R1(:,1);y=R1(:,2);z=R1(:,3);
ti=-0.5:0.01:1.5;
[XI,YI] = meshgrid(ti,ti);
ZI = griddata(x,y,z,XI,YI,'cubic');
tricontour([x y],tri,z,20);
text(-0.17,-0.1,'(a)','FontSize',40,'Units','Normalized');
print(f1,'OverlapPlot','-dpng','-r100');
close(f1);

f2=figure('Position', [100, 100, 800, 600], 'DefaultAxesFontSize',25);
t1=-0.5:0.0001:1.5;
I=t1(:)>=0.0 & t1(:)<=1.0;
w1=interp2(XI,YI,ZI,t1,0); [val1, idx1] = max(w1'.*I);
w2=interp2(XI,YI,ZI,0,t1); [val2, idx2] = max(w2.*I);
w3=interp2(XI,YI,ZI,t1,t1); [val3, idx3] = max(w3'.*I);
maxlocs=[t1(idx1) val1 val1/t1(idx1);t1(idx2) val2 val2/t1(idx2);t1(idx3) val3 val3/t1(idx3) ];
dlmwrite('max_overlap.dat',maxlocs,'delimiter',' ','precision','%.6f');
%set(gca,'units','points','position',[10,10,800,600]);
ah = axes; graph1 = plot(t1(1:250:end),w1(1:250:end)/493.23,'-r^',t1(1:250:end),w2(1:250:end)/493.23,'--bs',t1(1:250:end),w3(1:250:end)/493.23,'-.ko');
set(ah,'LineWidth',1.5);
set(ah,'OuterPosition',[0 0 1 1]);
set(ah,'Position', [0.13 0.12 0.775 0.8]);
set(graph1,'LineWidth',2);
legend(xlab1,ylab1,'[110]');
text(-0.17,-0.1,'(b)','FontSize',40,'Units','Normalized');
xlabel('t'); y1h=ylabel(strcat('V_{overlap} / V_{cell}'),'Interpreter','tex');
set(y1h, 'Units', 'Normalized', 'Position', [-0.09, 0.5, 0]);
print(f2,'Slices','-dpng','-r0');
close(f2);
